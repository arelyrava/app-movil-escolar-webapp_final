<div class="navbar-sidebar-wrapper">

  <nav class="scoop-side-navbar" *ngIf="!isMobileView">
    <ul class="scoop-navbar-list">

      <li *ngIf="canSeeRegisterItem()" routerLink="/registro-usuarios" routerLinkActive="active"
        class="scoop-navbar-item">
        <span class="material-icons">person_add</span>
        <span>Registro</span>
      </li>

      <li *ngIf="canSeeAdminItems()" routerLink="/administrador" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">admin_panel_settings</span>
        <span>Admins</span>
      </li>

      <li *ngIf="canSeeTeacherItems()" routerLink="/maestros" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">people</span>
        <span>Maestros</span>
      </li>

      <li *ngIf="canSeeStudentItems()" routerLink="/alumnos" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">school</span>
        <span>Alumnos</span>
      </li>

      <li *ngIf="canSeeStudentItems()" routerLink="/graficas" routerLinkActive="active" class="scoop-navbar-item">
        <span class="material-icons">bar_chart</span>
        <span>Gráficas</span>
      </li>

      <li *ngIf="canSeeTeacherItems()" routerLink="/materias" routerLinkActive="active"
        class="scoop-navbar-item">
        <span class="material-icons">library_books</span>
        <span>Materias</span>
      </li>

      <li *ngIf="canSeeStudentItems()" class="scoop-navbar-item" (click)="toggleMenu('eventos')"
          [class.active-parent]="expandedMenu === 'eventos'"
          style="cursor: pointer; justify-content: space-between;">

        <div style="display: flex; align-items: center;">
            <span class="material-icons">event</span>
            <span>Eventos Académicos</span>
        </div>

        <span class="material-icons"
              [style.transform]="expandedMenu === 'eventos' ? 'rotate(180deg)' : 'rotate(0deg)'"
              style="transition: transform 0.3s; font-size: 20px;">
          expand_more
        </span>
      </li>

      <ng-container *ngIf="expandedMenu === 'eventos'">

        <li routerLink="/eventos-lista" routerLinkActive="active" class="scoop-navbar-item"
            style="padding-left: 2.5rem; background-color: rgba(0,0,0,0.15); font-size: 0.9em;">
             <span class="material-icons" style="font-size: 18px;">list_alt</span>
             <span>Ver Lista</span>
        </li>

        <li *ngIf="isAdmin()" routerLink="/eventos-registro" routerLinkActive="active" class="scoop-navbar-item"
            style="padding-left: 2.5rem; background-color: rgba(0,0,0,0.15); font-size: 0.9em;">
             <span class="material-icons" style="font-size: 18px;">add_circle</span>
             <span>Registrar</span>
        </li>
      </ng-container>
      </ul>

    <button class="scoop-logout-btn" (click)="logout()">
      <span class="material-icons">logout</span>
      <span>Cerrar sesión</span>
    </button>
  </nav>

  <nav class="scoop-navbar">
    <button class="dashboard-toggle-btn" *ngIf="isMobileView" (click)="toggleSidebar()" aria-label="Abrir menú">
      <span class="material-icons">menu_open</span>
    </button>
    <span class="scoop-navbar-logo">BUAP</span>
    <div class="scoop-navbar-icons">
      <span class="material-icons navbar-icon" (click)="togglePalette()" style="cursor:pointer">palette</span>
      <div class="scoop-navbar-avatar" *ngIf="userInitial">{{ userInitial }}</div>
    </div>
  </nav>

  <ng-container *ngIf="isMobileView">
    <div class="mobile-sidebar-overlay" [ngClass]="{'mobile-open': mobileOpen}" (click)="closeSidebar()"></div>
    <nav class="scoop-side-navbar" [ngClass]="{'mobile-open': mobileOpen}">
      <ul class="scoop-navbar-list">

        <li *ngIf="canSeeRegisterItem()" routerLink="/registro-usuarios" routerLinkActive="active"
          class="scoop-navbar-item" (click)="closeSidebar()">
          <span class="material-icons">person_add</span>
          <span>Registro</span>
        </li>
        <li *ngIf="canSeeAdminItems()" routerLink="/administrador" routerLinkActive="active" class="scoop-navbar-item"
          (click)="closeSidebar()">
          <span class="material-icons">admin_panel_settings</span>
          <span>Admins</span>
        </li>
        <li *ngIf="canSeeAdminItems()" routerLink="/maestros" routerLinkActive="active" class="scoop-navbar-item"
          (click)="closeSidebar()">
          <span class="material-icons">people</span>
          <span>Maestros</span>
        </li>
        <li *ngIf="canSeeStudentItems()" routerLink="/alumnos" routerLinkActive="active" class="scoop-navbar-item"
          (click)="closeSidebar()">
          <span class="material-icons">school</span>
          <span>Alumnos</span>
        </li>
        <li *ngIf="canSeeStudentItems()" routerLink="/graficas" routerLinkActive="active" class="scoop-navbar-item"
          (click)="closeSidebar()">
          <span class="material-icons">bar_chart</span>
          <span>Gráficas</span>
        </li>
        <li *ngIf="canSeeTeacherItems()" routerLink="/materias" routerLinkActive="active"
          class="scoop-navbar-item" (click)="closeSidebar()">
          <span class="material-icons">library_books</span>
          <span>Materias</span>
        </li>

        <!-- Reestructuracion para la implementacion del menu dropdown-->

        <li *ngIf="canSeeStudentItems()" class="scoop-navbar-item" (click)="toggleMenu('eventos')"
            style="justify-content: space-between;">
            <div style="display: flex; align-items: center;">
                <span class="material-icons">event</span>
                <span>Eventos Académicos</span>
            </div>
            <span class="material-icons"
                  [style.transform]="expandedMenu === 'eventos' ? 'rotate(180deg)' : 'rotate(0deg)'"
                  style="transition: transform 0.3s;">
              expand_more
            </span>
        </li>

        <ng-container *ngIf="expandedMenu === 'eventos'">
            <li routerLink="/eventos-lista" routerLinkActive="active" class="scoop-navbar-item"
                (click)="closeSidebar()"
                style="padding-left: 2.5rem; background-color: rgba(0,0,0,0.15); font-size: 0.9em;">
                <span class="material-icons" style="font-size: 18px;">list_alt</span>
                <span>Ver eventos</span>
            </li>

            <li *ngIf="isAdmin()" routerLink="/eventos-registro" routerLinkActive="active" class="scoop-navbar-item"
                (click)="closeSidebar()"
                style="padding-left: 2.5rem; background-color: rgba(0,0,0,0.15); font-size: 0.9em;">
                <span class="material-icons" style="font-size: 18px;">add_circle</span>
                <span>Registrar Evento</span>
            </li>
        </ng-container>
        </ul>
      <button class="scoop-logout-btn" (click)="logout(); closeSidebar()">
        <span class="material-icons">logout</span>
        <span>Cerrar sesión</span>
      </button>
    </nav>
  </ng-container>
  </div>
